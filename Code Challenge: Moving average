-- SQL request(s)​​​​​​‌​‌‌‌​​‌​​‌​​​​‌‌​‌​​‌‌​​ below
SELECT
    o.CUSTOMERID,
    o.ORDERID,
    sum(d.PRICE) as ordertotal,
    ROUND(AVG(SUM(d.PRICE)) OVER (
        PARTITION BY o.CUSTOMERID 
        ORDER BY o.ORDERID 
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
    ), 2) as MovingAvg
FROM orders o
JOIN ordersdishes od on o.ORDERID = od.ORDERID
JOIN dishes d on d.dishid = od.dishid
group by o.ORDERID
order by o.CUSTOMERID, o.ORDERID

Correct output
1000 rows (929 not displayed)
-------------------------------------------------
| CUSTOMERID | ORDERID | ORDERTOTAL | MOVINGAVG |
-------------------------------------------------
| 1          | 133     | 38.98      | 38.98     |
| 1          | 172     | 45.98      | 42.48     |
| 1          | 225     | 18.99      | 34.65     |
| 1          | 249     | 49.98      | 38.32     |
| 1          | 401     | 45.98      | 38.32     |
| 1          | 455     | 27.98      | 41.31     |
| 1          | 623     | 43.99      | 39.32     |
| 1          | 645     | 28.99      | 33.65     |
| 1          | 683     | 16.00      | 29.66     |
| 1          | 762     | 36.97      | 27.32     |
| 1          | 789     | 38.00      | 30.32     |
| 1          | 907     | 30.99      | 35.32     |
| 1          | 937     | 16.99      | 28.66     |
| 1          | 972     | 33.00      | 26.99     |
| 2          | 54      | 57.96      | 57.96     |
| 2          | 111     | 11.00      | 34.48     |
| 2          | 114     | 48.98      | 39.31     |
| 2          | 312     | 39.98      | 33.32     |
| 2          | 338     | 14.00      | 34.32     |
| 2          | 344     | 19.98      | 24.65     |
| 2          | 454     | 19.98      | 17.99     |
| 2          | 518     | 50.95      | 30.30     |
| 2          | 556     | 47.98      | 39.64     |
| 2          | 706     | 29.98      | 42.97     |
| 2          | 792     | 24.99      | 34.32     |
| 2          | 854     | 40.99      | 31.99     |
| 2          | 921     | 46.98      | 37.65     |
| 2          | 950     | 16.00      | 34.66     |
| 3          | 75      | 36.97      | 36.97     |
| 3          | 107     | 26.98      | 31.98     |
| 3          | 277     | 24.99      | 29.65     |
| 3          | 406     | 39.98      | 30.65     |
| 3          | 440     | 47.97      | 37.65     |
| 3          | 527     | 19.98      | 35.98     |
| 3          | 736     | 53.98      | 40.64     |
| 3          | 750     | 25.00      | 32.99     |
| 3          | 868     | 42.98      | 40.65     |
| 3          | 986     | 46.98      | 38.32     |
| 4          | 36      | 27.99      | 27.99     |
| 4          | 62      | 29.99      | 28.99     |
| 4          | 367     | 51.97      | 36.65     |
| 4          | 425     | 19.98      | 33.98     |
| 4          | 435     | 42.99      | 38.31     |
| 4          | 488     | 41.99      | 34.99     |
| 4          | 783     | 39.99      | 41.66     |
| 4          | 998     | 30.97      | 37.65     |
| 5          | 91      | 20.00      | 20.00     |
| 5          | 378     | 21.99      | 21.00     |
| 5          | 622     | 34.99      | 25.66     |
| 5          | 624     | 14.00      | 23.66     |
| 5          | 675     | 37.98      | 28.99     |
| 5          | 721     | 43.98      | 31.99     |
| 5          | 767     | 47.98      | 43.31     |
| 5          | 838     | 11.00      | 34.32     |
| 5          | 903     | 14.00      | 24.33     |
| 6          | 51      | 34.98      | 34.98     |
| 6          | 76      | 15.00      | 24.99     |
| 6          | 182     | 49.99      | 33.32     |
| 6          | 255     | 31.00      | 32.00     |
| 6          | 309     | 30.97      | 37.32     |
| 6          | 376     | 26.99      | 29.65     |
| 6          | 405     | 45.98      | 34.65     |
| 6          | 444     | 47.98      | 40.32     |
| 6          | 469     | 16.99      | 36.98     |
| 6          | 507     | 28.00      | 30.99     |
| 6          | 541     | 31.98      | 25.66     |
| 6          | 555     | 35.98      | 31.99     |
| 6          | 637     | 21.00      | 29.65     |
| 7          | 3       | 16.00      | 16.00     |
| 7          | 125     | 24.99      | 20.50     |
| 7          | 156     | 30.99      | 23.99     |
[...]
